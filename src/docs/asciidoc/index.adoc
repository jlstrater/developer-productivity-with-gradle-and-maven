:example-caption!:
ifndef::imagesdir[:imagesdir: images]
ifndef::sourcedir[:sourcedir: ../java]
:status:
:title-slide-background-image: title.png
:title-slide-transition: zoom
:title-slide-transition-speed: fast
:icons: font
:revealjs_controls: false

= Schnelle und zuverl√§ssige Builds+++<br>+++mit Gradle und Maven

Marc Philipp, Gradle Inc.

== Wer bin ich?

[source,kotlin]
----
speaker {
    name = "Marc Philipp"
    home = "Karlsruhe, Germany"
    company = "Gradle Inc."
    title = "Senior Software Engineer"
    openSourceRoles = [
        "JUnit team lead"
    ]
    twitter = "@marcphilipp"
    github = "marcphilipp"
    web = uri("https://www.marcphilipp.de")
}
----

=== Gradle Inc.

* Build Happiness
* Products
** Gradle Build Tool
** Gradle Enterprise

=== Wie beeinflusst der Build die Entwicklerproduktivit√§t?

[%step]
* *20% Buildfehlschl√§ge*
  - Fixen 5-10% Teamzeit
* *Langsam*
  - Pro Minute 4% Teamzeit
* *Unzuverl√§ssig:* 5% Teamzeit

[NOTE.speaker]
--
Why is the Build so critical?

Builds are executed many, many times a day to constantly transform new code into software, to test it, to run it, to get any kind of feedback. The large teams build up to 100000 times a day.

Builds are code written on top of a build system, often hundred thousands or even millions of lines of code that are constantly evolving. The input of the build is constantly changing and affecting its efficiency. If such a build is not continuously managed and monitored, performance and reliability issues will severely affect the development productivity.

A single build execution takes a non-trivial amount of time, easily several minutes, often more than that. Waiting for the build to finish is often dead time for developers. One minute of extra build time per build destroys in average 4% of engineering capacity.

It is the job of the build to integrate all the latest code changes, run the tests and other checks to make sure that everything is still working. In average 20% of all builds fail because of code defects. This is fine and is actually the job of the build. But it often takes way too long to find the cause for such a failure. Easily 5-10% of engineering capacity are spend on this. Netflix has done internal studies that show that this consumes 20% of their engineering capacity.

The build code itself has often reliability issues. This is comparable to the assembly line and machines in a factory not working properly. Those problems are very hard to debug and can cause a lot of harm. Depending on the organization this can destroy 5% or more of their engineering capacity.

The build touches everything related to software development and provides a unique and valuable set of data if harvested. Not using this data makes it impossible to do develop software efficiently.

Every software team on the planet is severely affected by all those issues including a deep lack of insight. This is why we build GE.
--

[.dark.background]
== Schnelle Builds

image::subsection.png[background, size=cover]

=== Schnelle Builds

* Schneller = weniger machen
* Ergebnisse wiederverwenden!
** Inkrementeller Build
** Build Cache

=== Inkrementeller Build

* Gradle üëç
* Maven üëé

=== Inkrementeller Build

Gradle kann Ergebnisse +
des *letzten Mals* +
als *dieser Build* +
auf *diesem Computer* +
ausgef√ºhrt wurde wiederverwenden.

=== Das geht noch besser!

=== Wieso nicht...

von *irgendwann* +
wenn *irgendein Build* +
*irgendwo* ausgef√ºhrt wurde.

=== Noch besser...

f√ºr Maven und Gradle Builds!

[%notitle]
=== Maven vs. Gradle

image::maven-vs-gradle.png[height=auto]

=== Build Cache f√ºr Gradle

[%step]
[source,text]
----
$> gradle --build-cache assemble
:compileJava FROM-CACHE
:processResources
:classes
:jar
:assemble

BUILD SUCCESSFUL
----

=== Build Cache f√ºr Gradle

* Standardm√§√üig f√ºr Java, Groovy, Scala, C++ und Swift
* Unterst√ºtzt Compile, Test und Verification Tasks
* High-Performance Remote Backend von Gradle
* Docker Hub: https://hub.docker.com/r/gradle/build-cache-node/[gradle/build-cache-node]

=== Build Cache f√ºr Maven

* Eigene Extension (Teil von Gradle Enterprise)
* Initiales Release: M√§rz 2019
* Unterst√ºtzte Plugins: Java Compiler, Surefire/Failsafe, Javadoc, JAXB, Checkstyle

=== Build Cache ‚Äì Demo

=== Wie funktioniert der Build Cache?

- Berechne _cacheKey_ eines Tasks/Goals basierend auf seinen Inputs: +
  _cacheKey(javaCompile)_ = _hash(sourceFiles, ...)_
- Speichere die Outputs unter _cacheEntry_: +
  _cacheEntry[cacheKey(javaCompile)]_ = _fileTree(classFiles)_

[.stretch.plain]
image::task_inputs_outputs.svg[]

=== Lokaler und Remote Cache

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-01.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-02.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-03.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-04.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-05.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-06.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-07.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-08.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-09.svg[]

[%notitle,transition=none]
=== Lokaler und Remote Cache

[.stretch.plain]
image::caching-typical-scenario-10.svg[]

[.dark.background]
== Zuverl√§ssige Builds

image::subsection.png[background, size=cover]

=== Anforderungen

* Daten um Verbesserungen/Verschlechterungen festzustellen
** Entwickler- und CI-Builds
** Zuverl√§ssigkeit
** Geschwindigkeit

=== Was sind Build Scans?

* Aufzeichnung dar√ºber, was in einem Build passiert ist
* Permanente und teilbare URLs
* F√ºr Entwickler und Build Engineers

=== Gradle

[source,text]
----
$> gradle build --scan
...
BUILD SUCCESSFUL in 8m 22s
418 actionable tasks: 112 executed, 48 from cache, 258 up-to-date

Publishing build scan...
https://scans.gradle.com/s/lbmn7n4dngqgq
----

=== Maven

(mit in `.mvn/extensions.xml` registrierter Extension)

[source,text]
----
$> mvn clean verify
...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  5.262 s
[INFO] Finished at: 2019-04-23T09:55:36+02:00
[INFO] ------------------------------------------------------------------------
[INFO] 13 goals, 8 executed, 5 from cache, saving at least 16s
[INFO]
[INFO] Publishing build scan...
[INFO] https://gradle.com/s/ypgljbvelzxzs
[INFO]
----

=== Build Scans ‚Äì Demo

[NOTE.speaker]
--
* Navigate to summary, open performance tab, open timeline tab, open plugins view
* Show scan list
* Build categorization via Tags
--

=== Build Scans

* Unterst√ºtzen *Gradle _und_ Maven*
* *√ñffentliche Scans kostenlos* auf link:https://scans.gradle.com[scans.gradle.com]
** https://scans.gradle.com/s/nq7w6cjm72mak/
* *Gradle Enterprise* bietet zus√§tzliche Features und Hosting auf eigenem Server
** Build Comparison
** Performance Dashboard
** Build Trends

=== Eigene Analysen

* *Export API* benutzen!
* https://github.com/gradle/build-analysis-demo

image::build-analysis-data-pipeline.png[width=100%, height=auto]

[NOTE.speaker]
--
* Gradle Enterprise wird einige Analysen bekommen
* Gradle Enterprise soll kein BI Tool werden - gute Einsichten out-of-the-box, der Rest via Export API m√∂glich
--

[%notitle]
=== Dashboard

image::build-dashboard.png[height=auto]

[%notitle]
=== Dashboard

image::test-analytics.png[height=auto]

[NOTE.speaker]
--
√úber Flaky Test reden.
--

=== Materialien

* *Kostenlose Trainings* auf https://gradle.com/training/[gradle.com/training], z.B.:
  - Build Cache Deep Dive
  - Maven + Gradle Enterprise
* *https://www.youtube.com/channel/UCvClhveoEjokKIuBAsSjEwQ/videos[YouTube-Kanal]*
* *Gradle Build Tool:* https://gradle.org[]
* *Gradle Enterprise:* https://gradle.com[]

[.dark.background]
=== Vielen Dank!

image::subsection.png[background, size=cover]
image::thank-you.png[width=40%, height=auto]

[%notitle]
=== Feedback

image::etka-feedback.svg[background, size=contain]
